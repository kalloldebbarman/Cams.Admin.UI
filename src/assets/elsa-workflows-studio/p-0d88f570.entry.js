import{r as e,h as s}from"./p-ee0b9025.js";import{S as t}from"./p-f3f2f442.js";import{T as l}from"./p-6b50e59c.js";import{i as o,I as a,a as i}from"./p-bccf073e.js";import"./p-83f217d4.js";let r=class{constructor(s){e(this,s),this.jsonToDictionary=e=>{if(!e)return[["",""]];const s=JSON.parse(e);return Object.keys(s).map((e=>[e,s[e]]))},this.dictionaryToJson=e=>{const s=this.removeInvalidKeys(e);return 0===s.length?null:JSON.stringify(Object.fromEntries(s))},this.removeInvalidKeys=e=>{const s=[];return e.forEach((e=>{const t=e[0].trim();""===t||s.some((e=>e[0].trim()===t))||s.push(e)})),s},this.onRowAdded=()=>{this.currentValue=[...this.currentValue,["",""]]},this.onRowDeleted=e=>{const s=this.currentValue.filter(((s,t)=>t!==e));0===s.length&&s.push(["",""]),this.currentValue=s,this.propertyModel.expressions[t.Json]=this.dictionaryToJson(s)}}async componentWillLoad(){this.currentValue=this.jsonToDictionary(this.propertyModel.expressions[t.Json]||null),0===this.currentValue.length&&(this.currentValue=[["",""]])}onDefaultSyntaxValueChanged(e){this.currentValue=this.jsonToDictionary(e.detail)}onKeyChanged(e,s){this.currentValue[s][0]=e.currentTarget.value,this.propertyModel.expressions[t.Json]=this.dictionaryToJson(this.currentValue)}onValueChanged(e,s){this.currentValue[s][1]=e.currentTarget.value,this.propertyModel.expressions[t.Json]=this.dictionaryToJson(this.currentValue)}render(){const e=this.propertyDescriptor,t=e.name,l=this.currentValue;return s("elsa-property-editor",{propertyDescriptor:e,propertyModel:this.propertyModel,activityModel:this.activityModel,onDefaultSyntaxValueChanged:e=>this.onDefaultSyntaxValueChanged(e),"single-line":!0},l.map(((e,r)=>{const n=`${t}_${r}_key}`,h=`${t}_${r}_value}`,[c,u]=e,d=r===l.length-1;return s("div",{class:"elsa-flex elsa-flex-row elsa-justify-between elsa-mb-2"},s("input",{id:n,type:"text",value:c,onChange:e=>this.onKeyChanged(e,r),placeholder:"Name",class:"disabled:elsa-opacity-50 disabled:elsa-cursor-not-allowed focus:elsa-ring-blue-500 focus:elsa-border-blue-500 elsa-border-gray-300 sm:elsa-text-sm elsa-rounded-md elsa-w-5/12"}),s("input",{id:h,type:"text",value:u,onChange:e=>this.onValueChanged(e,r),placeholder:"Value",class:"disabled:elsa-opacity-50 disabled:elsa-cursor-not-allowed focus:elsa-ring-blue-500 focus:elsa-border-blue-500 elsa-border-gray-300 sm:elsa-text-sm elsa-rounded-md elsa-w-5/12"}),s("div",{class:"elsa-flex elsa-flex-row elsa-justify-between elsa-w-24"},s("button",{type:"button",onClick:()=>this.onRowDeleted(r)},o.getIcon(a.TrashBinOutline,{color:i.Gray,hoverColor:i.Red})),d&&s("button",{type:"button",onClick:this.onRowAdded},o.getIcon(a.Plus,{color:i.Gray,hoverColor:i.Green}))))})))}};l.injectProps(r,["serverUrl"]);export{r as elsa_dictionary_property}